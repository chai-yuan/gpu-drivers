TOP_DIR      := $(CURDIR)

SOURCE_DIR   := $(TOP_DIR)/demos
BUILD_DIR    := $(TOP_DIR)/build

MESON_OPTS := \
	-Dbuildtype=debug \
	-Dx11=enable	\
	-Degl=enable	\
	-Dlibdrm=enable	\
	-Dvulkan=disabled

.PHONY: all demo configure clean help

all: demo

demo: $(BUILD_DIR)/build.ninja
	@meson compile -C $(BUILD_DIR)
	@echo "   å¯æ‰§è¡Œæ–‡ä»¶ä½äº: $(BUILD_DIR)/src/"
	@echo "   ä¾‹å¦‚ï¼Œè¿è¡Œ: ./$(BUILD_DIR)/src/demos/gears"

run: demo
	$(BUILD_DIR)/src/demos/gears

configure: $(BUILD_DIR)/build.ninja

$(BUILD_DIR)/build.ninja: $(SOURCE_DIR)/meson.build
	@echo "--- âš™ï¸  æ­£åœ¨é…ç½®æ„å»ºç¯å¢ƒ (Meson) ---"
	@mkdir -p $(BUILD_DIR)
	@meson setup $(BUILD_DIR) $(SOURCE_DIR) $(MESON_OPTS)

clean:
	@echo "--- ğŸ§¹ æ­£åœ¨æ¸…ç†æ„å»ºç›®å½• ---"
	@rm -rf $(BUILD_DIR)
	@echo "æ¸…ç†å®Œæˆã€‚"
